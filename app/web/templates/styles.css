/* =============== Theming =============== */
:root{
  --pad:14px; --radius:14px;
  --bg:#ffffff; --bg-2:#fafafa;
  --text:#1b1f23; --muted:#5f6b7a;
  --border:#e5e7eb;
  --chip:#f2f2f2;
  --btn-bg:#f7f7f7; --btn-bg-active:#e8f0fe; --btn-border:#ddd; --btn-active:#b6c6ff;
  --row-alt:#fcfcfc; --row-hover:#f5f9ff;
  --overlay: rgba(0,0,0,.55);
}
body.dark{
  --bg:#0f141a; --bg-2:#121820;
  --text:#e7eef7; --muted:#9fb0c6;
  --border:#263241;
  --chip:#1f2a37;
  --btn-bg:#1a2330; --btn-bg-active:#16324a; --btn-border:#2b3a4d; --btn-active:#2d72d2;
  --row-alt:#0f1722; --row-hover:#132033;
  --overlay: rgba(0,0,0,.65);
}

/* =============== Base Layout =============== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; padding:var(--pad);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg); color:var(--text);
}
#wrap{max-width:1100px;margin:0 auto}
h1{margin:0 0 8px 0}

/* Controls */
#controls{display:grid;gap:8px;grid-template-columns:1fr;align-items:center;margin:8px 0 14px}
.controls-row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
input#ab-search, select#ab-sort, select#ab-page-size{
  flex:1 1 auto; padding:10px 12px; border:1px solid var(--border); border-radius:var(--radius);
  background:var(--bg-2); color:var(--text)
}
button.btn{
  padding:10px 12px; border:1px solid var(--btn-border); border-radius:var(--radius);
  background:var(--btn-bg); color:var(--text); cursor:pointer
}
button.btn:focus, select:focus, input:focus{ outline:2px solid #2d72d2; outline-offset:2px }
#meta{color:var(--muted)}

/* Dark mode switch */
.switch{ display:inline-flex; align-items:center; gap:8px; user-select:none }
.switch .label{font-size:.95em; color:var(--muted)}
.switch input{display:none}
.switch .track{
  width:46px; height:26px; border-radius:999px; position:relative;
  background:var(--btn-border); transition:background .2s
}
.switch .thumb{
  width:20px; height:20px; border-radius:50%; position:absolute; top:3px; left:3px;
  background:#fff; transition:left .2s, background .2s
}
body.dark .switch .thumb{ background:#dbeafe }
.switch input:checked + .track .thumb{ left:23px }
.switch input:checked + .track{ background:#2d72d2 }

/* Table */
table{border-collapse:collapse;width:100%}
th, td{border:1px solid var(--border); padding:10px; vertical-align:middle}
th{background:var(--bg-2); user-select:none; position:sticky; top:0; z-index:1}
tr:nth-child(even){background:var(--row-alt)}
tbody tr:hover{background:var(--row-hover)}
th[data-type="num"]{text-align:right}
td:nth-child(4){text-align:right}

/* Covers: de-bord cover cell + image/button */
td:first-child{width:72px; border-top: none; border-bottom: 1px solid var(--border); border-left: none; border-right: none;}
img.cover{width:56px;height:auto;border-radius:6px;display:block;border:none;box-shadow:none;background:transparent}
button.cover-btn{display:block;border:none;background:transparent;padding:0;cursor:pointer}
button.cover-btn:focus{ outline:2px solid #2d72d2; outline-offset:2px }

/* Cards */
#ab-cards{display:none;grid-template-columns:1fr;gap:10px}
.ab-card{
  border:1px solid var(--border); border-radius:var(--radius); padding:12px;
  background:var(--bg-2); cursor:pointer;
}
.ab-card:hover{background:var(--row-hover)}
.ab-card .t{font-weight:600;margin-bottom:4px;display:flex;align-items:center;gap:8px}
.ab-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:4px}
.ab-chip{background:var(--chip);padding:4px 8px;border-radius:999px;font-size:.9em;color:var(--text)}
.cover-inline{width:40px;height:auto;border-radius:6px;display:inline-block;vertical-align:middle}

/* Pagination */
.pagination{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.pagination-info{color:var(--muted)}
#ab-page-nav{display:flex;gap:6px;align-items:center;flex-wrap:wrap}
.page-btn{
  padding:6px 10px; border:1px solid var(--btn-border); border-radius:10px;
  background:var(--btn-bg); cursor:pointer; color:var(--text)
}
.page-btn.active, .page-btn:disabled{background:var(--btn-bg-active); border-color:var(--btn-active); cursor:default}

/* Empty state */
#ab-empty{
  display:none;
  border:1px dashed var(--border);
  border-radius:14px;
  padding:18px;
  background:var(--bg-2);
  color:var(--muted);
  text-align:center;
  margin-top:10px;
}

/* Modal viewer */
#modal{
  position:fixed; inset:0; display:none; align-items:center; justify-content:center;
  background:var(--overlay); z-index:9999; padding:20px
}
#modal.open{ display:flex }
#modal .panel{
  width:min(960px, 95vw); max-height:90vh; overflow:auto;
  background:var(--bg); color:var(--text); border:1px solid var(--border);
  border-radius:16px; display:grid; grid-template-columns: 240px 1fr; gap:16px; padding:16px;
}
#modal .panel .cover-lg{ width: 100%; height:auto; border-radius:12px; display:block }
#modal .meta-grid{ display:grid; grid-template-columns: 120px 1fr; gap:8px; align-items:start }
#modal .label{ color:var(--muted) }
#modal .title{ font-size:1.1rem; font-weight:700; margin-bottom:6px }
#modal .desc{ margin-top:10px; line-height:1.45; white-space:pre-wrap; color:var(--text) }
#modal .close{
  position:absolute; top:14px; right:14px;
  background:var(--btn-bg); border:1px solid var(--btn-border); border-radius:10px;
  padding:8px 10px; cursor:pointer; color:var(--text)
}
/* Link-style buttons */
a.link-btn{
  display:inline-block;
  padding:8px 10px;
  border:1px solid var(--btn-border);
  border-radius:10px;
  background:var(--btn-bg);
  color:var(--text);
  text-decoration:none;
  margin-top:4px;
}
a.link-btn:focus{ outline:2px solid #2d72d2; outline-offset:2px }

/* Responsive */
@media (max-width: 820px){
  body.cards #ab-table{display:none}
  body.cards #ab-cards{display:grid}
  body:not(.cards) #ab-cards{display:none}
  body:not(.cards) #ab-table{display:table}
  th, td{padding:12px}
  input#ab-search, select#ab-sort, input#ab-page-size, button.btn{padding:12px 14px}
  #modal .panel{ grid-template-columns: 1fr; }
}

/* Make table rows look clickable */
#ab-table tbody tr{ cursor:pointer; }