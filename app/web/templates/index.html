<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Audiobook Catalog</title>
<style>
:root {
  --pad: 14px;
  --radius: 14px;
  --muted: #666;
}
* { box-sizing: border-box; }
body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; margin:0; padding: var(--pad); }
#wrap { max-width: 1100px; margin: 0 auto; }
h1 { margin: 0 0 8px 0; }
#controls { display: grid; gap: 8px; grid-template-columns: 1fr; align-items: center; margin: 8px 0 14px; }
.controls-row { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
input#ab-search { flex:1 1 240px; padding:10px 12px; border:1px solid #ddd; border-radius: var(--radius); }
select#ab-sort, select#ab-page-size { padding:10px 12px; border:1px solid #ddd; border-radius: var(--radius); }
button.btn { padding:10px 12px; border:1px solid #ddd; border-radius: var(--radius); background:#f7f7f7; }
#meta { color: var(--muted); }

table { border-collapse: collapse; width: 100%; }
th, td { border: 1px solid #eee; padding: 10px; vertical-align: top; }
th { background: #fafafa; user-select: none; position: sticky; top: 0; z-index: 1; }
tr:nth-child(even) { background: #fcfcfc; }
th[data-type="num"] { text-align: right; }
td:nth-child(3) { text-align: right; } /* '#' column */

#ab-cards { display: none; grid-template-columns: 1fr; gap: 10px; }
.ab-card {
  border:1px solid #eee; border-radius: var(--radius); padding:12px;
  background:white; box-shadow: 0 1px 0 rgba(0,0,0,0.03);
}
.ab-card .t { font-weight: 600; margin-bottom: 4px; }
.ab-card .meta { color: var(--muted); font-size: 0.95em; }
.ab-row { display:flex; gap:8px; flex-wrap:wrap; margin-top:4px; }
.ab-chip { background:#f2f2f2; padding:4px 8px; border-radius:999px; font-size:0.9em; }

td:first-child { width: 72px; }           /* Cover column width */
img.cover { width: 56px; height: auto; border-radius: 6px; display:block; }
.cover-inline { width: 40px; margin-right: 8px; display:inline-block; vertical-align: middle; border-radius: 6px; }
.ab-card .t span { vertical-align: middle; }

.pagination { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.pagination-info { color: var(--muted); }
#ab-page-nav { display:flex; gap:6px; align-items:center; flex-wrap:wrap; }
.page-ellipsis { padding: 6px 4px; color: var(--muted); }
.page-btn { padding:6px 10px; border:1px solid #ddd; border-radius: 10px; background:#fafafa; cursor:pointer; }
.page-btn.active, .page-btn:disabled { background:#e8f0fe; border-color:#b6c6ff; cursor:default; }

@media (max-width: 820px) {
  body.cards #ab-table { display:none; }
  body.cards #ab-cards { display:grid; }
  /* Default to cards on small screens */
  body:not(.cards) #ab-cards { display:none; }
  body:not(.cards) #ab-table { display:table; }
  /* Improve tap targets */
  th, td { padding: 12px; }
  input#ab-search, select#ab-sort, select#ab-page-size, button.btn { padding:12px 14px; }
}
</style>
</head>
<body class="cards"><div id="wrap">
<h1>Audiobook Catalog</h1>
<div id="controls">
  <div class="controls-row">
    <input id="ab-search" type="text" placeholder="Search any field..." />
    <select id="ab-sort">
      <option value="title|txt">Sort by Title</option>
      <option value="series|txt">Sort by Series</option>
      <option value="series_index_sort|num">Sort by # (numeric)</option>
      <option value="author|txt">Sort by Author</option>
      <option value="narrator|txt">Sort by Narrator</option>
      <option value="year|txt">Sort by Year</option>
      <option value="genre|txt">Sort by Genre</option>
      <option value="duration_hhmm|txt">Sort by Duration</option>
    </select>
    <button id="ab-sort-asc" class="btn">Asc</button>
    <button id="ab-sort-desc" class="btn">Desc</button>
    <button id="ab-toggle-view" class="btn">Toggle View</button>
  </div>

  <div class="controls-row pagination">
    <label for="ab-page-size"><small>Rows per page:</small></label>
    <select id="ab-page-size">
      <option value="10">10</option>
      <option value="20">20</option>
      <option value="50">50</option>
      <option value="100" selected>100</option>
      <option value="500">500</option>
      <option value="All">All</option>
    </select>

    <button id="ab-page-first" class="btn">« First</button>
    <button id="ab-page-prev"  class="btn">‹ Prev</button>
    <div id="ab-page-nav"></div>
    <button id="ab-page-next"  class="btn">Next ›</button>
    <button id="ab-page-last"  class="btn">Last »</button>

    <span id="ab-page-info" class="pagination-info"></span>
  </div>

  <div id="meta"><small>
    Generated at: {{GENERATED_AT}} ·
    <a href="{{CSV_LINK}}" download>Download CSV</a>{{DRIVE_LINK_BLOCK}}
  </small></div>
</div>
<table id="ab-table"><thead><tr>
  <th data-key="cover_href">Cover</th>
  <th data-key="title">Title</th>
  <th data-key="series">Series</th>
  <!-- IMPORTANT: like 18:26:21, key is the *display* column -->
  <th data-key="series_index_display" data-type="num">#</th>
  <th data-key="author">Author</th>
  <th data-key="narrator">Narrator</th>
  <th data-key="year">Year</th>
  <th data-key="genre">Genre</th>
  <th data-key="duration_hhmm">Duration (hh:mm)</th>
</tr></thead>
<tbody>
  {{TABLE_ROWS}}
</tbody></table>

<div id="ab-cards">
  {{CARDS}}
</div>
</div>
<!-- Keep using your existing JS for search/sort/pagination -->
<script src="../static/app.js"></script>
</body>
</html>
